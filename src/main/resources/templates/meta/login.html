<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <title>Meta System - Login</title>
    <link rel="stylesheet" href="/css/login.css">
</head>
<body>
<div class="login-container">
    <main class="login-box">
        <h2>Meta System Login</h2>
        <div class="form-row">
            <label for="userId" class="form-label">ID<span class="required">*</span></label>
            <input type="text" id="userId" placeholder="ID 입력" class="form-input">
        </div>
        <div class="form-row">
            <label for="password" class="form-label">PASSWORD<span class="required">*</span></label>
            <input type="password" id="password" placeholder="PASSWORD 입력" class="form-input">
        </div>
        <div class="btn-wrap">
            <button id="btnReg" class="btn">LOG IN</button>
        </div>
    </main>
</div>

<script>

    document.addEventListener('DOMContentLoaded', () => {

      const btn = document.getElementById('btnReg');

      btn.addEventListener('click', async () => {

          const userId = document.getElementById('userId').value.trim();
          const password = document.getElementById('password').value.trim();

          if (!userId || !password) {
              alert('ID와 PASSWORD를 모두 입력하세요.');
              return;
          }

          const data = { userId, password };

          try {
              const response = await fetch("/meta/getLogin", {
                  method: "POST",
                  headers: { "Content-Type": "application/json" },
                  body: JSON.stringify(data)
              });

              if (!response.ok) throw new Error("서버 오류 발생");

              const result = await response.json();

              if (result.success) {
                localStorage.setItem('userId', result.data.userId);
                localStorage.setItem('userNm', result.data.userNm);
                localStorage.setItem('role', result.data.role);

                window.location.href = '/meta/dashboard';
              } else {
                  alert("Login 실패: " + result.message);
              }

          } catch (err) {
              console.error(err);
              alert("요청 중 오류가 발생했습니다.");
          }
      });

  });


</script>
</body>
</html>
